# 产品需求文档 (PRD) - NoStop: AI 智能路线规划器
**版本**: 4.0 (草稿)
**日期**: 2026-01-30
**状态**: 提案

## 1. 简介

### 1.1 目的
本文档旨在定义 **NoStop (AI 版)** 的需求。本次迭代集成了 **Minimax 大语言模型 (LLM)** 能力，将产品从基于规则的路线查找器转变为智能、具备上下文感知的骑行助手。它满足了用户对自然交互和深度环境风险评估的需求。

### 1.2 范围
**NoStop** 是一个 Web/移动端工具，利用 AI 来：
1.  **意图解析**: 理解自然语言请求（如“今晚想找个安静的 30km 绕圈”）。
2.  **语义评分**: 使用“常识推理”识别传统地图忽略的环境风险（如夜市、学校区域）。
3.  **情感化生成**: 提供听起来像资深骑行教练的路线点评。
4.  **导出**: 交付标准的 GPX 文件以实现硬件兼容性。

### 1.3 定义
*   **意图解析 (Intent Parsing)**: 从非结构化文本/语音中提取结构化参数（距离、氛围、时间）。
*   **语义安全评分 (Semantic Safety Scoring)**: 基于特定时间的环境上下文评估道路安全性（如“周五晚上” + “夜市” = 高风险）。
*   **AI 探路报告 (AI Scouting Report)**: 生成的叙述性文本，描述路线特征和具体建议。

## 2. 总体描述

### 2.1 产品视角
NoStop 作为一个覆盖在标准地图数据之上的智能层。
流程: **用户 (自然语言)** -> **AI Agent (解析 & 规划)** -> **地图服务 (数据)** -> **AI Agent (评分 & 叙述)** -> **用户 (审查 & 导出)**。

### 2.2 用户特征
*   **目标用户**: 注重效率和安全的资深骑行者。
*   **行为**: 他们更喜欢对话式的高效交互，而非复杂的 UI 控件。相比原始数据，他们更信任“专家建议”。

### 2.3 产品功能
1.  **对话式路线规划**:
    *   输入: “我想做个 20km 的快速骑行，不要爬坡，要很安全。”
    *   输出: AI 提取 `distance: 20km`, `elevation: flat`, `safety_weight: high`。
2.  **语义安全引擎**:
    *   逻辑: 将候选路线与 POI 数据（学校、市场、工厂）和时间进行交叉比对。
    *   动作: 降级具有高“隐形风险”的路线（如商场附近的配送员热点区域）。
3.  **AI 探路报告**:
    *   输出: “这条路线非常适合你的恢复骑行。全程 90% 都是非机动车道。注意在第 5 公里处靠近商场的地方——晚上 7 点左右那里送外卖的电动车很多。”

## 3. 具体需求

### 3.1 功能需求

#### 3.1.1 AI 意图解析 (Minimax 集成)
*   **FR-1.1**: 系统应接受文本输入。
*   **FR-1.2**: 系统应调用 Minimax API 提取:
    *   目标距离 (如 "30km")。
    *   目标时间 (如 "1 小时" -> ~25km)。
    *   氛围/偏好 (如 "安静" -> 低流量权重; "快速" -> 低转弯权重)。
*   **FR-1.3**: 如果意图不明确，系统应回退到默认值（如默认 30km）。

#### 3.1.2 语义安全评分
*   **FR-2.1**: 系统应识别路线 50 米范围内的 POI。
*   **FR-2.2**: 系统应使用 Minimax 评估“上下文风险”:
    *   *输入*: POI 类型 (如 "夜市"), 当前时间 (如 "周五 20:00")。
    *   *推理*: "夜市在 20:00 活跃意味着高行人/电动车流量。"
    *   *输出*: 风险评分 (0-100)。
*   **FR-2.3**: 系统应过滤掉风险评分 > 阈值的路线。

#### 3.1.3 AI 探路报告生成
*   **FR-3.1**: 系统应为选定的路线生成 100 字的摘要。
*   **FR-3.2**: 语气应为“专业、鼓励、警示”。
*   **FR-3.3**: 内容必须包含:
    *   亮点 (路线最棒的部分)。
    *   建议 (特定危险位置)。
    *   适宜性 (如 "适合 FTP 测试")。

### 3.2 用户界面需求
*   **输入**: 显眼的聊天/搜索栏: “告诉我你今天想骑什么...”
*   **输出**: 卡片布局，顶部为 AI 摘要，随后是地图和数据。

### 3.3 性能需求
*   **AI 延迟**: 意图解析 < 2s; 路线点评 < 3s。
*   **流式传输**: 对点评使用流式响应以减少感知延迟。

## 4. 验证策略
*   **图灵测试精简版**: 向用户展示 AI 生成的路线报告与人工撰写的报告。目标：用户偏好 AI 版本或无法区分。
*   **风险规避测试**: 向系统输入已知的“坏路线”（如穿过繁忙的夜市）。如果 AI 识别出风险并降低评分，则为成功。

## 5. 路线图 (Roadmap)
*   **v1.0 (AI MVP)**: 文本输入 -> 路线生成 -> AI 点评。
*   **v1.1**: 语音输入支持。
*   **v1.2**: 个性化 AI (记住用户过去的偏好: “像上周二那样，但长一点”)。
